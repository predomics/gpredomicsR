% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/visu.R
\name{plot_population_heatmap}
\alias{plot_population_heatmap}
\title{Plot a Heatmap of a Model Population with Signed Color Gradient}
\usage{
plot_population_heatmap(
  exp,
  pop_index = length(exp$model_collection),
  focus_fbm = TRUE,
  score = "fit",
  p = 0.05,
  clustering_distance = "euclidean",
  clustering_method = "complete",
  scale = "none",
  ...
)
}
\arguments{
\item{exp}{A \code{gpredomics} experiment object containing the model collection and training data.}

\item{pop_index}{An integer specifying which population index to use from \code{exp$model_collection}
(default is the last population).}

\item{focus_fbm}{Logical. If TRUE (default), selects the top models using \code{selectBestPopulation()}.
If FALSE, uses the full population without filtering.}

\item{score}{A character string indicating which score to use for model selection (default is \code{"fit"}).}

\item{p}{A numeric value between 0 and 1 indicating the proportion of top models to retain (default is \code{0.05}).}

\item{clustering_distance}{Distance metric used for hierarchical clustering (\code{"euclidean"} by default).}

\item{clustering_method}{Method used for clustering (\code{"complete"} by default).}

\item{scale}{Scaling method passed to \code{pheatmap} (\code{"none"} by default).}

\item{...}{Additional arguments passed to \code{pheatmap()} (e.g., \code{annotation_col}, \code{fontsize}, etc.).}
}
\value{
Invisibly returns the output of \code{pheatmap()}. The heatmap is displayed as a side effect.
}
\description{
This function extracts a model population from a \code{gpredomics} experiment object,
optionally selects the top-performing models, computes the dense coefficient matrix,
and visualizes it as a clustered heatmap. The color scale is centered on zero,
with negative values in red, positive values in green, and zero in white.
}
\examples{
\dontrun{
  # Plot heatmap using filtered best models
  plot_population_heatmap(exp)

  # Plot heatmap using all models from generation 5
  plot_population_heatmap(exp, pop_index = 5, focus_fbm = FALSE)
}
}
